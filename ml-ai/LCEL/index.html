<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LCEL (LangChain Expression Language) 1</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="stylesheet" href="/assets/css/study.css">
    <link rel="stylesheet" href="/assets/css/sidebar.css">
    <link rel="stylesheet" href="/assets/css/header.css">
    <link rel="stylesheet" href="/assets/css/banner.css">
    <link rel="stylesheet" href="/assets/css/sections.css">
    <link rel="stylesheet" href="/assets/css/post.css">
    <link rel="stylesheet" href="/assets/css/categories.css">
    <link rel="stylesheet" href="/assets/css/projects.css">
</head>
<body>
    <div class="container">
        <!-- ì‚¬ì´ë“œë°” -->
        <aside class="sidebar">
    <img src="/assets/images/avatar.png" alt="Duri" class="profile-image">
    <div class="profile-info">
        <h2>Duri</h2>
        <p>Ë—ËË‹ â‹†ï½¡ğ–¦¹ Ëš ğ“‡¼ Ëšï½¡â‹† â€Ë–Â°</p>
        <p>ì˜›ë‚ ì— 
 ë°ì´í„° ì—”ì§€ë‹ˆì–´ê°€ ìˆì—‡ìŠ¨.. ë°±ì—”ë“œ ì„œë²„ë„ ë§Œë“¤ê³  ì¸í”„ë¼ë„ êµ¬ì¶•í•˜ê³  ë°ì´í„° ë¶„ì„ë„ í–ˆìŠ¨.. </p>
    </div>
    
    <div class="contact-links">
        <div class="profile-divider">
    â €â €â €â €â €â €â¢€â¡¤â£¤â£€â €â €â €â €â €â €â €â €â €â €â£€â¡€â €â €â €â €â €â €
    â €â €â €â €â €â¢€â¡â €â €â ˆâ ³â£„â €â €â €â €â €â£€â ´â ‹â ‰â ‰â¡†â €â €â €â €â €
    â €â €â €â €â €â¢¸â €â €â €â €â €â ˆâ ‰â ‰â ™â “â šâ â €â €â €â €â£¿â €â €â €â €â €
    â €â €â €â €â¢€â â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â ¹â£„â €â €â €â €
    â €â €â €â €â¡â €â €â €â €â €â ¶â €â €â €â €â €â €â ¦â €â €â €â €â €â ¸â¡†â €â €â €
    â¢ â£¤â£¶â£¾â£§â£¤â£¤â£€â¡€â €â €â €â €â ˆâ €â €â €â¢€â¡¤â ´â ¶â ¤â¢¤â¡€â£§â£€â£€â €
    â »â ¶â£¾â â €â €â €â €â ™â£†â €â €â €â €â €â €â£°â ‹â €â €â €â €â €â¢¹â£¿â£­â£½â ‡
    â €â €â ™â ¤â ´â¢¤â¡¤â ¤â ¤â ‹â ‰â ‰â ‰â ‰â ‰â ‰â ‰â ³â –â ¦â ¤â ¶â ¦â â â €â €â €
        </div>
        
        <a href="https://github.com/duri-wip" class="contact-link" target="_blank">
            <i class="fab fa-github"></i>
            <span>GitHub</span>
        </a>
        
        
        <a href="mailto:8s.eow.ooc@gmail.com" class="contact-link">
            <i class="fas fa-envelope"></i>
            <span>Email</span>
        </a>
        
    </div>
    
</aside>
        
        <!-- ë©”ì¸ ì½˜í…ì¸  -->
        <main class="main-content">
            <!-- í—¤ë” -->
            <header class="header">
    <nav>
        <ul class="nav-menu">
            <li class="nav-item">
                <a href="/">home</a>
            </li>
            <li class="nav-item">
                <a href="/categories">category</a>
            </li>
            <li class="nav-item">
                <a href="/study">study</a>
            </li>
            <li class="nav-item">
                <a href="/projects">project</a>
            </li>
        </ul>
    </nav>
</header>
            
            <!-- ì½˜í…ì¸  ì˜ì—­ -->
            <div class="content">
                <article class="post">
    <header class="post-header">
        <h1 class="post-title">LCEL (LangChain Expression Language) 1</h1>
        <div class="post-meta">
            <time class="post-date">2025ë…„ 07ì›” 24ì¼</time>
            
            <div class="post-categories">
                
                    
                    <span class="category-tag">ML-AI</span>
                    
                
                    
                
                
                <span class="subcategory-tag">llm</span>
                
            </div>
            
            
            <div class="post-tags">
                
                <span class="tag">#genai-llm</span>
                
                <span class="tag">#langchain</span>
                
                <span class="tag">#lcel</span>
                
                <span class="tag">#chain</span>
                
                <span class="tag">#ai</span>
                
                <span class="tag">#llm</span>
                
                <span class="tag">#python</span>
                
                <span class="tag">#genai</span>
                
                <span class="tag">#study-llm-framework</span>
                
            </div>
            
        </div>
    </header>

    <div class="post-content">
        <h1 id="lcelì´ë€">LCELì´ë€?</h1>

<p>LangChainì—ì„œ chainì„ êµ¬ì„±í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤. í”„ë¡¬í”„íŠ¸ë‚˜ LLMì„ <code class="language-plaintext highlighter-rouge">|</code> ë¡œ ì—°ê²°í•˜ì—¬ ì‘ì„±í•˜ê³  ì²˜ë¦¬ì˜ ì—°ì‡„ë¥¼ êµ¬ì„±í•œë‹¤.</p>

<blockquote>
  <p>LCELì—ì„œëŠ” ì™œ í”„ë¡¬í”„íŠ¸, ëª¨ë¸, ì•„ì›ƒí’‹ íŒŒì„œë“±ì„ <code class="language-plaintext highlighter-rouge">|</code>(ì²´ì¸)ìœ¼ë¡œ ì—°ê²°í•´ì„œ ì‹¤í–‰í•  ìˆ˜ ìˆì„ê¹Œ?</p>
</blockquote>

<p>ëª¨ë“  í´ë˜ìŠ¤ê°€ langchainì˜ <strong>Runnable</strong> í´ë˜ìŠ¤ë¥¼ ìƒì†ë°›ê³  ìˆê¸° ë•Œë¬¸ì´ë‹¤.
Runnableì„ ì—°ê²°í•˜ë©´ <strong>RunnableSequence</strong>ê°€ ëœë‹¤. ì´ ì‹œí€€ìŠ¤ë„ Runnableì˜ ì¼ì¢…ì´ë‹¤.
RunnableSequenceë¥¼ invokeí•˜ë©´ runnableì´ ìˆœì„œëŒ€ë¡œ invokeëœë‹¤.</p>

<h2 id="lcel-ë‚´ë¶€-êµ¬í˜„">LCEL ë‚´ë¶€ êµ¬í˜„</h2>

<p>LCELì€ ì–´ë–»ê²Œ êµ¬í˜„ë˜ì—ˆê¸¸ë˜ ì²´ì¸ìœ¼ë¡œ ëª¨ë¸ê³¼ í”„ë¡¬í”„íŠ¸ë¥¼ ì—°ê²°í•  ìˆ˜ ìˆì„ê¹Œ?
<code class="language-plaintext highlighter-rouge">__or__</code>ê³¼ <code class="language-plaintext highlighter-rouge">__ror__</code>ê°€ ì´ë ‡ê²Œ êµ¬í˜„ë˜ì–´ ìˆë‹¤:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">__or__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span>
    <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Runnable</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Other</span><span class="p">],</span>
                <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Other</span><span class="p">]],</span>
                <span class="n">Callable</span><span class="p">[</span><span class="n">Iterator</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Other</span><span class="p">]],</span>
                <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">Runnable</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span><span class="n">Other</span><span class="p">]],</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span><span class="n">Other</span><span class="p">],</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">RunnableSerializable</span><span class="p">[</span><span class="n">Input</span><span class="p">,</span> <span class="n">Other</span><span class="p">]:</span>
        <span class="k">return</span> <span class="nc">RunnableSequence</span><span class="p">(</span><span class="n">first</span><span class="o">=</span><span class="n">self</span><span class="p">,</span> <span class="n">last</span><span class="o">=</span><span class="nf">coerce_to_runnable</span><span class="p">(</span><span class="n">other</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">__ror__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span>
    <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Runnable</span><span class="p">[</span><span class="n">Other</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
                <span class="n">Callable</span><span class="p">[[</span><span class="n">Other</span><span class="p">],</span> <span class="n">Any</span><span class="p">]],</span>
                <span class="n">Callable</span><span class="p">[</span><span class="n">Iterator</span><span class="p">[</span><span class="n">Other</span><span class="p">],</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Any</span><span class="p">]],</span>
                <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">Runnable</span><span class="p">[</span><span class="n">Other</span><span class="p">,</span><span class="n">Any</span><span class="p">]],</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Other</span><span class="p">],</span><span class="n">Any</span><span class="p">],</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">RunnableSerializable</span><span class="p">[</span><span class="n">Other</span><span class="p">,</span> <span class="n">Output</span><span class="p">]:</span>
        <span class="k">return</span> <span class="nc">RunnableSequence</span><span class="p">(</span><span class="n">first</span><span class="o">=</span><span class="nf">coerce_to_runnable</span><span class="p">(</span><span class="n">other</span><span class="p">),</span> <span class="n">last</span><span class="o">=</span><span class="n">self</span><span class="p">)</span>
</code></pre></div></div>

<p>ì´ ì—°ì‚°ìë“¤ì„ í†µí•´ ì²´ì¸ì„ ì˜¤ë²„ë¡œë“œí•  ìˆ˜ ìˆë‹¤.</p>

<p>ê·¸ëŸ¬ë‹ˆê¹Œ ì›ë˜ë¼ë©´ ê°ê°ì˜ ëŸ¬ë„ˆë¸”ì„ ì‹¤í–‰(í˜¸ì¶œ)í•˜ëŠ” ë°©ë²•ì´ ë‹¬ë¼, ì´ ì»´í¬ë„ŒíŠ¸ë“¤ì„ ì—°ê²°í•˜ëŠ” ì²˜ë¦¬ë¥¼ ê°œë³„ì ìœ¼ë¡œ êµ¬í˜„í•´ì•¼í•˜ëŠ”ë°, LCELì„ ì‚¬ìš©í•˜ë©´ ëª¨ë“  ì»´í¬ë„ŒíŠ¸ë¥¼ <strong>í†µì¼ëœ ì¸í„°í˜ì´ìŠ¤</strong>ë¡œ í˜¸ì¶œí•  ìˆ˜ ìˆê²Œ ëœë‹¤. ì´ê²Œ ì—„ì²­ í¸ë¦¬í•¨!!</p>

<h2 id="lcelì´-í¸ë¦¬í•œ-ìœ ìŠ¤ì¼€ì´ìŠ¤">LCELì´ í¸ë¦¬í•œ ìœ ìŠ¤ì¼€ì´ìŠ¤</h2>

<ul>
  <li>í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿ì„ ì±„ìš°ê³ , ê·¸ ê²°ê³¼ë¥¼ ì±— ëª¨ë¸ì— ì œê³µí•˜ê³  ê²°ê³¼ë¥¼ íŒŒì´ì¬ ê°ì²´ë¡œ ë³€í™˜í•˜ê³  ì‹¶ë‹¤.</li>
  <li>í”„ë¡¬í”„íŒ…ìœ¼ë¡œ ë‹¨ê³„ë³„ë¡œ ìƒê°í•˜ê²Œ í•˜ê³  ê·¸ ê²°ê³¼ë¥¼ ìš”ì•½í•˜ê²Œ í•˜ê³  ì‹¶ë‹¤</li>
  <li>ì¶œë ¥ì„ ì–»ì€ í›„ì— ì„œë¹„ìŠ¤ ì •ì±…ì— ìœ„ë°˜ë˜ì§€ ì•ŠëŠ”ì§€ í™•ì¸í•˜ê³  ì‹¶ë‹¤</li>
  <li>ì¶œë ¥ ê²°ê³¼ë¥¼ ë°”íƒ•ìœ¼ë¡œ SQLì„ ì‹¤í–‰í•˜ì—¬ ë°ì´í„°ë¥¼ ë¶„ì„í•˜ê³  ì‹¶ë‹¤.</li>
</ul>

<h1 id="ì‚¬ìš©-ë°©ë²•">ì‚¬ìš© ë°©ë²•</h1>

<h2 id="1-promptì™€-model-ì—°ê²°í•˜ê¸°">1. Promptì™€ Model ì—°ê²°í•˜ê¸°</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">langchain_core.prompts</span> <span class="kn">import</span> <span class="n">ChatPromptTemplate</span>
<span class="kn">from</span> <span class="n">langchain_openai</span> <span class="kn">import</span> <span class="n">ChatOpenAI</span>

<span class="n">prompt</span> <span class="o">=</span> <span class="n">ChatPromptTemplate</span><span class="p">.</span><span class="nf">from_messages</span><span class="p">([</span>
    <span class="p">(</span><span class="sh">"</span><span class="s">system</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">You are a helpful assistant that can answer questions.</span><span class="sh">"</span><span class="p">),</span>
    <span class="p">(</span><span class="sh">"</span><span class="s">human</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">{input}</span><span class="sh">"</span><span class="p">)</span>
<span class="p">])</span>

<span class="n">model</span> <span class="o">=</span> <span class="nc">ChatOpenAI</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="sh">"</span><span class="s">gpt-4o-mini</span><span class="sh">"</span><span class="p">,</span> <span class="n">temperature</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">)</span>

<span class="c1"># ì²´ì¸ ìƒì„±
</span><span class="n">chain</span> <span class="o">=</span> <span class="n">prompt</span> <span class="o">|</span> <span class="n">model</span>

<span class="n">ai_message</span> <span class="o">=</span> <span class="n">chain</span><span class="p">.</span><span class="nf">invoke</span><span class="p">({</span><span class="sh">"</span><span class="s">input</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">What is the capital of France?</span><span class="sh">"</span><span class="p">})</span>
<span class="nf">print</span><span class="p">(</span><span class="n">ai_message</span><span class="p">.</span><span class="n">content</span><span class="p">)</span>
</code></pre></div></div>

<ul>
  <li>ë­ì²´ì¸ì„ ì•ˆì“°ëŠ” ê²½ìš°ì™€ í¬ê²Œ ë‹¬ë¼ë³´ì´ì§€ ì•ŠëŠ”ë‹¤. ê·¸ë ‡ì§€ë§Œ í”„ë¡¬í”„íŠ¸ê°€ ë‹¤ì–‘í•´ì§€ê³ , ì›Œí¬í”Œë¡œìš°ê°€ ë³µì¡í•´ì§€ëŠ” ê²½ìš°ì—ëŠ” ì´ êµ¬ì¡°ê°€ ì•„ì£¼ í¸ë¦¬í•´ì§„ë‹¤.</li>
</ul>

<p>ì˜ˆë¥¼ ë“¤ì–´ë³´ì.</p>

<h3 id="ì˜ˆì‹œ-prompt-model-pydantic-output-parser-ì—°ê²°í•˜ê¸°">ì˜ˆì‹œ) Prompt, Model, Pydantic Output Parser ì—°ê²°í•˜ê¸°</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">langchain_core.output_parsers</span> <span class="kn">import</span> <span class="n">PydanticOutputParser</span>
<span class="kn">from</span> <span class="n">pydantic</span> <span class="kn">import</span> <span class="n">BaseModel</span><span class="p">,</span> <span class="n">Field</span><span class="p">,</span> <span class="n">List</span>

<span class="c1"># ì‘ë‹µ í˜•ì‹ ëª¨ë¸ ì„¤ì •
</span><span class="k">class</span> <span class="nc">Recipe</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">dish</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="nc">Field</span><span class="p">(</span><span class="n">description</span> <span class="o">=</span> <span class="sh">"</span><span class="s">ë¨¹ê³ ì‹¶ì€ ìŒì‹ì˜ ì´ë¦„</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">recipe</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="nc">Field</span><span class="p">(</span><span class="n">description</span> <span class="o">=</span> <span class="sh">"</span><span class="s">ìŒì‹ì˜ ìš”ë¦¬ë²•</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">ingredient</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nc">Field</span><span class="p">(</span><span class="n">description</span> <span class="o">=</span> <span class="sh">"</span><span class="s">í•„ìš”í•œ ì¬ë£Œì˜ ëª©ë¡</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># ì—°ì‡„ ì²˜ë¦¬í•  ë¶€ë¶„
</span><span class="n">prompt</span> <span class="o">=</span> <span class="n">ChatPromptTemplate</span><span class="p">.</span><span class="nf">from_messages</span><span class="p">([...])</span>

<span class="n">output_parser</span> <span class="o">=</span> <span class="nc">PydanticOutputParser</span><span class="p">(</span><span class="n">pydantic_object</span> <span class="o">=</span> <span class="n">Recipe</span><span class="p">)</span>
<span class="n">prompt_input</span> <span class="o">=</span> <span class="n">prompt</span><span class="p">.</span><span class="nf">partial</span><span class="p">(</span>
    <span class="n">format_instructions</span> <span class="o">=</span> <span class="n">output_parser</span><span class="p">.</span><span class="nf">get_format_instructions</span><span class="p">()</span>
<span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="nc">ChatOpenAI</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="sh">"</span><span class="s">gpt-4o-mini</span><span class="sh">"</span><span class="p">,</span> <span class="n">temperature</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">).</span><span class="nf">bind</span><span class="p">(</span>
    <span class="n">response_format</span> <span class="o">=</span> <span class="p">{</span><span class="sh">"</span><span class="s">type</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">json_object</span><span class="sh">"</span><span class="p">}</span>
<span class="p">)</span>

<span class="n">chain</span> <span class="o">=</span> <span class="n">prompt_input</span> <span class="o">|</span> <span class="n">model</span> <span class="o">|</span> <span class="n">output_parser</span>

<span class="n">output</span> <span class="o">=</span> <span class="n">chain</span><span class="p">.</span><span class="nf">invoke</span><span class="p">({</span><span class="sh">"</span><span class="s">input</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">ë‹¹ê·¼ ì¹´ë ˆ</span><span class="sh">"</span><span class="p">})</span>
</code></pre></div></div>

<ul>
  <li>ì´ë ‡ê²Œ í•˜ë©´ ì—¬ëŸ¬ê°œì˜ ëŸ¬ë„ˆë¸”ë„ ê°„ë‹¨í•˜ê²Œ í•œì¤„ë¡œ ì—°ê²°í•  ìˆ˜ ìˆë‹¤.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ë™ì¼í•œ ê¸°ëŠ¥ì„ í•˜ëŠ” ê°„ë‹¨í•œ ë‹¤ë¥¸ ë°©ë²•
</span><span class="n">chain2</span> <span class="o">=</span> <span class="n">prompt</span> <span class="o">|</span> <span class="n">model</span><span class="p">.</span><span class="nf">with_structured_output</span><span class="p">(</span><span class="n">Recipe</span><span class="p">)</span>

<span class="n">output2</span> <span class="o">=</span> <span class="n">chain2</span><span class="p">.</span><span class="nf">invoke</span><span class="p">({</span><span class="sh">"</span><span class="s">input</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">ì–‘íŒŒ ì¹´ë ˆ</span><span class="sh">"</span><span class="p">})</span>
</code></pre></div></div>

<h2 id="2-lcelì˜-ê³ ê¸‰-ì—°ì‚°ìë“¤">2. LCELì˜ ê³ ê¸‰ ì—°ì‚°ìë“¤</h2>

<p><strong>RunnableParallel (ë³‘ë ¬ ì‹¤í–‰):</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">langchain_core.runnables</span> <span class="kn">import</span> <span class="n">RunnableParallel</span>

<span class="c1"># ì—¬ëŸ¬ ì‘ì—…ì„ ë™ì‹œì— ì‹¤í–‰
</span><span class="n">parallel_chain</span> <span class="o">=</span> <span class="nc">RunnableParallel</span><span class="p">(</span>
    <span class="n">summary</span><span class="o">=</span><span class="n">prompt</span> <span class="o">|</span> <span class="n">model</span> <span class="o">|</span> <span class="nc">StrOutputParser</span><span class="p">(),</span>
    <span class="n">keywords</span><span class="o">=</span><span class="n">keyword_prompt</span> <span class="o">|</span> <span class="n">model</span> <span class="o">|</span> <span class="nc">StrOutputParser</span><span class="p">(),</span>
    <span class="n">sentiment</span><span class="o">=</span><span class="n">sentiment_prompt</span> <span class="o">|</span> <span class="n">model</span> <span class="o">|</span> <span class="nc">StrOutputParser</span><span class="p">()</span>
<span class="p">)</span>
</code></pre></div></div>

<p><strong>RunnableLambda (í•¨ìˆ˜ ë³€í™˜):</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">langchain_core.runnables</span> <span class="kn">import</span> <span class="n">RunnableLambda</span>

<span class="k">def</span> <span class="nf">format_input</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">{</span><span class="sh">"</span><span class="s">input</span><span class="sh">"</span><span class="p">:</span> <span class="n">x</span><span class="p">.</span><span class="nf">upper</span><span class="p">()}</span>

<span class="n">chain</span> <span class="o">=</span> <span class="nc">RunnableLambda</span><span class="p">(</span><span class="n">format_input</span><span class="p">)</span> <span class="o">|</span> <span class="n">prompt</span> <span class="o">|</span> <span class="n">model</span>
</code></pre></div></div>

<p><strong>RunnableBranch (ì¡°ê±´ë¶€ ë¶„ê¸°):</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">langchain_core.runnables</span> <span class="kn">import</span> <span class="n">RunnableBranch</span>

<span class="n">chain</span> <span class="o">=</span> <span class="nc">RunnableBranch</span><span class="p">(</span>
    <span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="sh">"</span><span class="s">question</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">x</span><span class="p">.</span><span class="nf">lower</span><span class="p">(),</span> <span class="n">question_chain</span><span class="p">),</span>
    <span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="sh">"</span><span class="s">summary</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">x</span><span class="p">.</span><span class="nf">lower</span><span class="p">(),</span> <span class="n">summary_chain</span><span class="p">),</span>
    <span class="n">default_chain</span>  <span class="c1"># ê¸°ë³¸ê°’
</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="ì£¼ì˜í• -ì --ì…ì¶œë ¥-íƒ€ì…ì´-ì¼ì¹˜í• -ê²ƒ">ì£¼ì˜í•  ì  : ì…ì¶œë ¥ íƒ€ì…ì´ ì¼ì¹˜í•  ê²ƒ!</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># íƒ€ì… ë¶ˆì¼ì¹˜ ì˜ˆì‹œ (ì—ëŸ¬ ë°œìƒ)
</span><span class="n">prompt_returns_messages</span> <span class="o">=</span> <span class="n">ChatPromptTemplate</span><span class="p">.</span><span class="nf">from_template</span><span class="p">(</span><span class="sh">"</span><span class="s">Hello {name}</span><span class="sh">"</span><span class="p">)</span>
<span class="n">parser_expects_string</span> <span class="o">=</span> <span class="nc">StrOutputParser</span><span class="p">()</span>

<span class="c1"># ì˜¬ë°”ë¥¸ ì—°ê²°
</span><span class="n">chain</span> <span class="o">=</span> <span class="n">prompt_returns_messages</span> <span class="o">|</span> <span class="n">model</span> <span class="o">|</span> <span class="n">parser_expects_string</span>
</code></pre></div></div>

<p><strong>ì£¼ì˜ì‚¬í•­:</strong></p>

<ul>
  <li>ChatPromptTemplate â†’ AIMessage ê°ì²´ ì¶œë ¥</li>
  <li>StrOutputParser â†’ AIMessage.content (string) ì¶”ì¶œ</li>
  <li>ì¤‘ê°„ì— ëª¨ë¸ì´ AIMessage ìƒì„±í•´ì•¼ í•¨</li>
</ul>

    </div>

    <footer class="post-footer">
        <div class="post-nav">
            
            <a class="prev-post" href="/ml-ai/output-parse/">
                <span class="nav-label">ì´ì „ ê¸€</span>
                <span class="nav-title">LangChain Output Parser</span>
            </a>
            
            
            
            <a class="next-post" href="/ml-ai/LCEL2/">
                <span class="nav-label">ë‹¤ìŒ ê¸€</span>
                <span class="nav-title">LCEL (LangChain Expression ...</span>
            </a>
            
        </div>
        
        <div class="back-to-home">
            <a href="/">â† í™ˆìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>
        </div>
    </footer>
</article>
            </div>
        </main>
    </div>
</body>
</html>